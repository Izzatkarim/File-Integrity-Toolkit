<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Digital Forensic Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0; /* Remove margins */
            padding: 0; /* Remove padding */
            font-size: 10pt; /* Adjust font size for better fitting */
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 18px; /* Smaller heading */
        }

        .report-header {
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-bottom: 5px;
        }

        .report-meta {
            display: flex;
            justify-content: space-between;
            color: #7f8c8d;
            font-size: 0.85em; /* Adjust meta size */
            margin-bottom: 10px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px; /* Reduced gap between items */
            margin: 10px 0; /* Reduced margin */
        }

        .summary-card {
            padding: 8px; /* Reduced padding */
            border-radius: 5px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .summary-card h3 {
            margin: 0 0 8px 0;
            font-size: 0.9em; /* Smaller font size */
            color: white;
        }

        .summary-card p {
            font-size: 1.3em; /* Slightly smaller font size */
            font-weight: bold;
            margin: 0;
            color: white;
        }

        .modified { background-color: #c7ce00; }
        .new { background-color: #edbd6a; }
        .deleted { background-color: #ca7d00e6; }
        .suspicious { background-color: #c63f3f; }

        .finding {
            margin: 5px 0; /* Reduced margin between findings */
            padding: 12px 0; /* Reduced padding for findings */
            border-left: 4px solid;
            background-color: #f8f9fa;
            page-break-inside: avoid;
        }

        .finding h3 {
            margin: 5px 0; /* Reduced margin for header */
            color: #2c3e50;
        }

        .finding.suspicious_file {
            border-left-color:  #e74c3c;
            background-color: #f5eef8;
        }

        /* Color matching for finding details */
        .finding.modified {
            border-left-color: #c7ce00;
            background-color:  #fcfdcb; /* Same as Modified File box */
        }

        .finding.new {
            border-left-color: #edbd6a;
            background-color: #ffebc8; /* Same as New File box */
        }

        .finding.deleted {
            border-left-color: #ca7d00e6;
            background-color: #fff0d8e6; /* Same as Deleted File box */
        }

        /* Leave Suspicious Files color unchanged */
        .finding.suspicious_file {
            color: #c63f3f; /* Same as Suspicious Files box */
        }

        .finding-details p {
            margin: 4px 0; /* Reduced margin for finding details */
            padding: 0; /* No padding */
        }

        .threat-score {
            font-weight: bold;
            color: #e74c3c;
        }

        .hash-value {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            word-break: break-all;
            background-color: #f1f1f1;
            padding: 2px 4px;
            border-radius: 3px;
        }

        footer {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            font-size: 0.85em;
            color: #7f8c8d;
            text-align: center;
        }

        @media print {
            body {
                margin: 0mm; /* No margin for print */
                padding: 0;
                font-size: 9pt; /* Adjust font size for print */
            }

            .summary-card {
                padding: 8px; /* Reduced padding for print */
            }

            .finding {
                padding: 8px;
                margin: 5px 0;
            }

            .finding-details p {
                font-size: 9pt; /* Smaller font size in print */
            }

            footer {
                margin-top: 15px;
                padding-top: 10px;
            }

            .summary-grid {
                gap: 5px; /* Reduced gap for print */
            }
        }
    </style>
</head>
<body>
    <div class="report-header">
        <h1>Digital Forensic Integrity Report</h1>
        <div class="report-meta">
            <span>Generated: {{ report_date }}</span>
            <span>Findings: {{ finding_count }}</span>
        </div>
    </div>

    <section class="executive-summary">
        <h2>Executive Summary</h2>
        <div class="summary-grid">
            <div class="summary-card modified">
                <h3>Modified Files</h3>
                <p>{{ finding_stats.modified }}</p>
            </div>
            <div class="summary-card new">
                <h3>New Files</h3>
                <p>{{ finding_stats.new }}</p>
            </div>
            <div class="summary-card deleted">
                <h3>Deleted Files</h3>
                <p>{{ finding_stats.deleted }}</p>
            </div>
            <div class="summary-card suspicious">
                <h3>Suspicious Files</h3>
                <p>{{ finding_stats.suspicious }}</p>
            </div>
        </div>
    </section>

    <section class="detailed-findings">
        <h2>Detailed Findings</h2>
        {% for finding in findings %}
        <div class="finding {{ finding.type|lower|replace(' ', '_') }}">
            <h3>{{ finding.type }}</h3>
            <div class="finding-details">
                <p><strong>File:</strong> {{ finding.file }}</p>
                
                {% if finding.type == 'SUSPICIOUS FILE' %}
                <p><strong>Threat Score:</strong> 
                   <span class="threat-score">{{ finding.details.threat_info.positives }}/{{ finding.details.threat_info.total }} detections</span></p>
                <p><strong>SHA256:</strong> <span class="hash-value">{{ finding.details.hash }}</span></p>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </section>

    <footer>
        <p>Generated by File Integrity Forensic Toolkit</p>
    </footer>
</body>
</html>
